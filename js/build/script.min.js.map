{"version":3,"sources":["../page.js","../arrivals.js"],"names":["$","ViewModel","self","this","arrivals","ko","observableArray","vm","extend","FastClick","attach","document","body","jQuery","ArrivalViewModel","title","status","time","ArrivalApiService","getAll","get","then","response","ArrivalAdapter","toArrivalViewModel","data","toArrivalViewModels","length","_","map","item","ArrivalController","arrivalApiService","arrivalAdapter","arrivalController","addClass","removeClass","applyBindings","setInterval"],"mappings":"CAAA,SAAUA,GAGN,QAASC,aACL,GAAIC,MAAOC,IACXD,MAAKE,SAAWC,GAAGC,oBAIvB,GAAIC,IAAK,GAAIN,UACbD,GAAEQ,OAAOR,GACLO,GAAIA,KAGRP,EAAE,WAEES,UAAUC,OAAOC,SAASC,SAG/BC,QCnBH,WACI,QAASC,oBACL,GAAIZ,MAAOC,IACXD,MAAKa,MAAQ,GACbb,KAAKc,OAAS,GACdd,KAAKe,KAAO,GAGhB,QAASC,qBACL,GAAIhB,MAAOC,IAGXD,MAAKiB,OAAS,WACV,MAAOnB,GAAEoB,IAAI,UAAUC,KAAK,SAASC,UACjC,MAAOA,aAKnB,QAASC,kBACL,GAAIrB,MAAOC,IAEXD,MAAKsB,mBAAqB,SAASC,MAC/B,GAAIA,KAAM,CACN,GAAIlB,IAAK,GAAIO,iBAIb,OAHAP,IAAGQ,MAAQU,KAAKV,MAChBR,GAAGS,OAASS,KAAKT,OACjBT,GAAGU,KAAOQ,KAAKR,KACRV,GAEX,MAAO,OAGXL,KAAKwB,oBAAsB,SAASD,MAChC,MAAIA,OAAQA,KAAKE,OAAS,EACfC,EAAEC,IAAIJ,KAAM,SAASK,MACxB,MAAO5B,MAAKsB,mBAAmBM,YAO/C,QAASC,mBAAkBC,kBAAmBC,gBAC1C,GAAI/B,MAAOC,IAEXD,MAAKiB,OAAS,WAEV,MAAOa,mBAAkBb,SAASE,KAAK,SAASC,UAC5C,MAAOW,gBAAeP,oBAAoBJ,cAKtD,SAAUtB,GAEN,GAAIgC,mBAAoB,GAAId,mBACxBe,eAAiB,GAAIV,gBAGrBW,kBAAoB,GAAIH,mBAAkBC,kBAAmBC,eAGjEjC,GAAE,kBAAkBmC,SAAS,WAC7BD,kBAAkBf,SAASE,KAAK,SAASC,UAErCtB,EAAEO,GAAGH,SAASkB,UACdtB,EAAE,kBAAkBoC,YAAY,aAEpC/B,GAAGgC,cAAcrC,EAAEO,GAGJ+B,aAAY,WACvBtC,EAAE,kBAAkBmC,SAAS,WAC7BD,kBAAkBf,SAASE,KAAK,SAASC,UAErCtB,EAAEO,GAAGH,SAASkB,UACdtB,EAAE,kBAAkBoC,YAAY,cAErC,MACJvB","file":"script.min.js","sourcesContent":["(function($) {\n\n    // declare the view model used within the page\n    function ViewModel() {\n        var self = this;\n        self.arrivals = ko.observableArray([]);\n    }\n\n    // expose the view model through $\n    var vm = new ViewModel();\n    $.extend($, {\n        vm: vm\n    });\n\n    $(function() {\n        // fastclick\n        FastClick.attach(document.body);\n    });\n\n})(jQuery);","(function() {\n    function ArrivalViewModel() {\n        var self = this;\n        self.title = \"\";\n        self.status = \"\";\n        self.time = \"\";\n    }\n\n    function ArrivalApiService() {\n        var self = this;\n\n        // retrieves all arrivals from the API\n        self.getAll = function() {\n            return $.get(\"./api/\").then(function(response) {\n                return response;\n            });\n        };\n    }\n\n    function ArrivalAdapter() {\n        var self = this;\n\n        self.toArrivalViewModel = function(data) {\n            if (data) {\n                var vm = new ArrivalViewModel();\n                vm.title = data.title;\n                vm.status = data.status;\n                vm.time = data.time;\n                return vm;\n            }\n            return null;\n        };\n\n        self.toArrivalViewModels = function(data) {\n            if (data && data.length > 0) {\n                return _.map(data, function(item) {\n                    return self.toArrivalViewModel(item);\n                });\n            }\n            return [];\n        };\n    }\n\n    function ArrivalController(arrivalApiService, arrivalAdapter) {\n        var self = this;\n\n        self.getAll = function() {\n            // retrieve all the arrivals from the API\n            return arrivalApiService.getAll().then(function(response) {\n                return arrivalAdapter.toArrivalViewModels(response);\n            });\n        };\n    }\n\n    (function($) {\n        // initialize the services and adapters\n        var arrivalApiService = new ArrivalApiService();\n        var arrivalAdapter = new ArrivalAdapter();\n\n        // initialize the controller\n        var arrivalController = new ArrivalController(arrivalApiService, arrivalAdapter);\n\n        // retrieve all routes\n        $(\".arrivals-list\").addClass(\"loading\");\n        arrivalController.getAll().then(function(response) {\n            // bind the arrivals to the UI\n            $.vm.arrivals(response);\n            $(\".arrivals-list\").removeClass(\"loading\");\n        });\n        ko.applyBindings($.vm);\n\n        // constantly ping to retrieve the latest routes\n        var interval = setInterval(function() {\n            $(\".arrivals-list\").addClass(\"loading\");\n            arrivalController.getAll().then(function(response) {\n                // bind the arrivals to the UI\n                $.vm.arrivals(response);\n                $(\".arrivals-list\").removeClass(\"loading\");\n            });\n        }, 3000);\n    })(jQuery);\n})();\n"]}